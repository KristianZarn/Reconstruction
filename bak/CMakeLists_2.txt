cmake_minimum_required(VERSION 3.10)
project(realtime_reconstruction)

set(CMAKE_CXX_STANDARD 17)

# LIBRARIES

# Theia library
find_package(Theia REQUIRED)

# Libigl library
find_path(LIBIGL_INCLUDE_DIR igl/readOBJ.h
        PATHS $ENV{HOME}/Sources/libigl
        PATH_SUFFIXES include)

find_path(LIBIGL_LIBS_DIR libigl_core.a
        PATHS $ENV{HOME}/Sources/libigl/optional
        PATH_SUFFIXES build)

add_library(igl::core STATIC IMPORTED)
set_property(TARGET igl::core PROPERTY IMPORTED_LOCATION ${LIBIGL_LIBS_DIR}/libigl_core.a)

add_library(igl::opengl STATIC IMPORTED)
set_property(TARGET igl::opengl PROPERTY IMPORTED_LOCATION ${LIBIGL_LIBS_DIR}/libigl_opengl.a)

add_library(igl::opengl_glfw STATIC IMPORTED)
set_property(TARGET igl::opengl_glfw PROPERTY IMPORTED_LOCATION ${LIBIGL_LIBS_DIR}/libigl_opengl_glfw.a)

add_library(igl::opengl_glfw_imgui STATIC IMPORTED)
set_property(TARGET igl::opengl_glfw_imgui PROPERTY IMPORTED_LOCATION ${LIBIGL_LIBS_DIR}/libigl_opengl_glfw_imgui.a)

add_library(igl::png STATIC IMPORTED)
set_property(TARGET igl::png PROPERTY IMPORTED_LOCATION ${LIBIGL_LIBS_DIR}/libigl_png.a)

# Imgui from Libigl external
find_path(IMGUI_INCLUDE_DIR imgui/imgui.h
        PATHS $ENV{HOME}/Sources/libigl/external/imgui)

# TARGETS

# Main realtime reconstruction target
add_executable(realtime_reconstruction
        main.cpp
        src/webcam.cpp)

target_include_directories(realtime_reconstruction
        PUBLIC
        ${CMAKE_SOURCE_DIR}/src
        ${LIBIGL_INCLUDE_DIR}
        ${IMGUI_INCLUDE_DIR}
        ${THEIA_INCLUDE_DIRS})

target_link_libraries(realtime_reconstruction
        PRIVATE
        igl::core
        igl::opengl
        igl::opengl_glfw
        igl::opengl_glfw_imgui
        igl::png)
